---
layout: default
title: Contact
---

<div class="email-form js-email-form">
  <h2 class="section-title">Shoot me an email</h2>

  <div class="contact-control">
    <label for="email-subject">Subject</label>
    <input type="text" class="with-focus-effect js-email-subject" id="email-subject">
  </div>
  
  <div class="contact-control-pair">
    
    <div class="contact-control">
      <label for="email-from-name">Name</label>
      <input type="text" class="with-focus-effect js-email-from-name" id="email-from-name">
    </div>

    <div class="contact-control">
      <label for="email-from-address">Email Address</label>
      <input type="text" class="with-focus-effect js-email-from-address" id="email-from-address">
    </div>

  </div>
  
  <div class="contact-control">
    <label for="email-text">Body</label>
    <textarea class="with-focus-effect js-email-text" id="email-text"></textarea>
  </div>

  <button type="button" class="with-focus-effect email-send js-email-send">Send</button>
</div>

<div class="response-message loading-message js-loading-message">
  <div class="status-icon loading-icon">&#8635;</div>
</div>

<div class="response-message error-message js-error-message">
  <div class="status-icon error-icon">&#10008;</div>
  <p class="status-message">Something went wrong, sorry about that! Try me on <a href="http://twitter.com/nickhbottomley">Twitter</a>.</p>
</div>

<div class="response-message success-message js-success-message">
  <div class="status-icon success-icon">&#10004;</div>
  <p class="status-message">I'll get back to you ASAP. In the meantime, check out my <a href="#">blog</a> or my projects on <a href="#">GitHub</a>.</p>
</div>

<script src="{{ site.baseurl }}public/js/blog.js"></script>
<script src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
<script>

  ( function( $, Parse ) {

    Parse.initialize( 
      "imcjoYKVqSTyp0LzQgEok5UjWYr84nOpp8O1gZny", // public app id.
      "g0Gqz8Cd7KGC2enGfyWMWZZJ5VQhxpsDzwgyQfUP"  // public javascript key.
    );

    var Email = Parse.Object.extend( "Email" );

    var emailForm = $( ".js-email-form" )
    var emailSubject = $( ".js-email-subject" );
    var emailFromName = $( ".js-email-from-name" );
    var emailFromAddress = $( ".js-email-from-address" );
    var emailText = $( ".js-email-text" );
    var emailSend = $( ".js-email-send" );

    var loadingMessage = $( ".js-loading-message" );
    var errorMessage = $( ".js-error-message" );
    var successMessage = $( ".js-success-message" );
    var messages = $( ".js-loading-message, .js-error-message, .js-success-message" );

    var duration = 400;

    var dfd = $.Deferred();

    function createEmailInstance() {

      emailForm.fadeOut( duration, function(){
        dfd.resolve();
      });

      var email = new Email();
      var text = emailText.val().trim();
      var subject = emailSubject.val().trim();
      var fromName = emailFromName.val().trim();
      var fromAddress = emailFromAddress.val().trim();

      if ( text && subject && fromName && fromAddress ) {

        email.set({
          text: text,
          subject: subject,
          fromName: fromName,
          fromAddress: fromAddress
        });

        email.save( null, {
          success: function(){
            sendEmail( email );
          },
          error: sendError
        });

      } else {
        sendError();
      }

    }

    function sendEmail( email ) {
      Parse.Cloud.run( "sendEmail", email.toJSON(), {
        success: sendSuccess,
        error: sendError
      });
    };

    function sendComplete() {
      var dfd = $.Deferred();
      emailForm.fadeOut( duration, function() {
        dfd.resolve();
      });
      return dfd.promise();
    }

    function sendSuccess( response ) {
      dfd.promise().then( function() {
        successMessage.fadeIn( duration );
      });
    }

    function sendError( response ) {
      dfd.promise().then( function() {
        errorMessage.fadeIn( duration );
      });
    }

    emailSend.one( "click", createEmailInstance );

  })( jQuery, Parse );

</script>